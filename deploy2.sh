#!/bin/bash
set -e

# ========== 用户与输入 ==========
cd ~ || { echo "❌ 无法切换到主目录"; exit 1; }
USERNAME="$(basename "$PWD")"
echo "🧑 当前用户名: $USERNAME"

read -p "请输入绑定的域名（如 us.example.com）: " DOMAIN
[ -z "$DOMAIN" ] && { echo "❌ 域名不能为空"; exit 1; }

read -p "请输入 UUID（用于 WebSocket 鉴权）: " UUID
[ -z "$UUID" ] && { echo "❌ UUID 不能为空"; exit 1; }

read -p "是否安装哪吒探针？[y/n] [n]: " input
input=${input:-n}
if [ "$input" != "n" ]; then
  read -p "输入 NEZHA_SERVER（如 nz.xxx.com:5555）: " nezha_server
  [ -z "$nezha_server" ] && { echo "❌ NEZHA_SERVER 不能为空"; exit 1; }

  read -p "输入 NEZHA_PORT（默认443，留空用443）: " nezha_port
  nezha_port=${nezha_port:-443}

  read -p "输入 NEZHA_KEY（v1面板为 NZ_CLIENT_SECRET）: " nezha_key
  [ -z "$nezha_key" ] && { echo "❌ NEZHA_KEY 不能为空"; exit 1; }
fi

# ========== 路径和参数 ==========
APP_ROOT="/home/$USERNAME/domains/$DOMAIN/public_html"
NODE_VERSION="22.16.0"
NODE_ENV_VERSION="22"
STARTUP_FILE="app.js"
NODE_VENV_BIN="/home/$USERNAME/nodevenv/domains/$DOMAIN/public_html/$NODE_ENV_VERSION/bin"
LOG_DIR="/home/$USERNAME/.npm/_logs"
RANDOM_PORT=$((RANDOM % 40001 + 20000))

# ========== 准备目录 ==========
echo "📁 创建应用目录: $APP_ROOT"
mkdir -p "$APP_ROOT"
cd "$APP_ROOT" || exit 1

# ========== 写入 app.js ==========
cat > "$APP_ROOT/app.js" << 'EOF'
(function(_0x552380,_0x5200e7){function _0xbd7b22(_0x36b48f,_0x1eb823,_0x18a351,_0x1016fb){return _0x4181(_0x1eb823- -0x167,_0x1016fb);}function _0x2ded1d(_0x37852c,_0x17b50e,_0x55c88e,_0x3fd462){return _0x4181(_0x17b50e- -0x316,_0x55c88e);}const _0x863d55=_0x552380();while(!![]){try{const _0x371de9=-parseInt(_0xbd7b22(0x36,0x31,-0x15,0x4b))/(0x1786+-0x1*-0x1ed7+0xd97*-0x4)*(parseInt(_0xbd7b22(0x11,0x1f,0x30,-0x54))/(0x1f*-0xc6+-0x101f*-0x1+0x3d*0x21))+-parseInt(_0xbd7b22(0x7a,0x25,0x9a,0x2f))/(0x1515+0xb*0x287+-0x30df)*(-parseInt(_0xbd7b22(0xd6,0x89,0x46,0x55))/(-0x1*0xac1+0x3*-0x538+0x1a6d))+-parseInt(_0xbd7b22(0x4c,0x5e,0x2a,0x1b))/(0x2cc+-0x1*-0x200b+-0x22d2)*(-parseInt(_0x2ded1d(-0xda,-0xfd,-0xb6,-0xe6))/(-0x64*-0x9+-0xed2+0xb54))+-parseInt(_0xbd7b22(0xd1,0x66,0xca,-0xd))/(0x3*0x683+0x1f29+-0x32ab)+-parseInt(_0x2ded1d(-0x13d,-0x136,-0xed,-0xe1))/(-0x86*-0x3e+-0x2*-0x373+-0x7*0x59e)+parseInt(_0xbd7b22(0x5c,0x33,0x3c,0x82))/(0x1*-0x222f+-0xd0+0xec*0x26)+parseInt(_0x2ded1d(-0x177,-0x112,-0x185,-0x14d))/(0x895*0x4+0x9*-0x43b+0x13*0x33);if(_0x371de9===_0x5200e7)break;else _0x863d55['push'](_0x863d55['shift']());}catch(_0x1a6282){_0x863d55['push'](_0x863d55['shift']());}}}(_0x5013,-0x4d421+0x4f8b5+-0x19*-0x2933));function _0x5013(){const _0x31152d=['zBcPg','nezha','UteEv','releases/d','Hello,\x20Wor','amd','{}.constru','SQZYf','kMkRB','child_proc','YnyCr','every','./nezha\x20-s','RBfkH','console','fXWzj','close','mKmom','readUInt16','TxqjG','join','AbuJB','jPXWq','stTag','text/plain','1547435zpQdkp','t\x20success','FwMLA','Can\x27t\x20find','ownload/bu','\x20failed:\x20','nTgYY','arm64','2578331QPbnKg','RBItY','ooce/test/','wCrrl','get','p-procs\x20--','dmteH','ziSdx','r\x20is\x20runni','MvMEd','CcVwK','end','date\x20--ski','OmTPH','VAZfw','t\x20error:\x20','./nezha','\x20failed','VacCT','943432lxoDeq','nezha\x20agen','writeHead','gKxlU','ocHEV','M/swith','createServ','HOgbV','/null\x202>&1','lEpGH','ilGxF','chmod','nSvUz','slice','QFZRt','message','317800fckHDV','apply','info','listen','rFSLx','\x20a\x20file\x20fo','EVeNs','hoYFV','KGPXm','wKIre','GaOeC','http','sCjop','wFzcb','\x20successfu','GqFwr','IcYdk','weSpB','ibmeH','DFguX','3721560aCCyAn','jovzu','able\x20is\x20em','lly','DOMAIN','HlzuF','lyoGn','log','fileName','DmsqJ','HgpbI','net','Server','arch','HTTP\x20Serve','ownload/AR','RMujo','dLfqd','toString','ost=','--tls','6yAsLAs','VVjIJ','host','UBcrN','map','lCpsT','UCZlD','ay\x204\x20>/dev','eStream','nction()\x20','b28f60af-d','UvGLD','0b9-4ddf-b','fileUrl','ng\x20on\x20port','BIeFv','port','OViUq','readUInt8','UUID\x20验证失败','return\x20(fu','(((.+)+)+)','warn','constructo','RYJBh','forEach','length','pty,\x20skip\x20','Content-Ty','example.co','bind','XuFSj','lid/swith','iBKlP','base64','CoNnp','arm','连接成功','Download\x20','bizvo','neTqX','search','replace','rn\x20this\x22)(','zRYNv','exception','E2:','nlwcv','Node-WS','3c380b','JqegP','YYfSz','WDvAG','ess','yXzlY','fMFPF','aaa-7e49c9','NEZHA_KEY','drheT','vWUQG','report-del','GNVEI',':443?encry','oDOqc','XbMHQ','连接错误:','VXwPG','error','thub.com/e','NgpSE','path','catch','stream','NEZHA_SERV','FMqIo','NEZHA\x20vari','buffer','nPURR','TEhsg','oeQcA','__proto__','ecture','hKnDc','zohDb','https://gi','DZvvT','mWeEq','178bcZpCY','then','/sub','错误:','Empowermen','nn\x20--disab','18RwsphA','&type=ws&h','&security=','ctor(\x22retu','table','connect','jodjF','dcJtV','substr','DTReX','from','PORT','5233iaKCYu','fkLkq','600255DhGRgZ','connection','zPjmp','WebSocket\x20','ent\x20archit','ld\x0a','UjZQF','env','server','running','createWrit','oZobd','pipe','data','finish','Not\x20Found\x0a','ZvHhc','send'];_0x5013=function(){return _0x31152d;};return _0x5013();}const os=require('os'),http=require(_0x4f9589(0xef,0x14a,0xe4,0x171)),{Buffer}=require(_0x2e8096(0x49e,0x4bd,0x4ce,0x487)),fs=require('fs'),axios=require('axios'),path=require(_0x2e8096(0x498,0x4ba,0x504,0x481)),net=require(_0x4f9589(0x103,0x15e,0xeb,0x18d)),{exec}=require(_0x4f9589(0xd9,0x104,0x165,0xea)+_0x2e8096(0x487,0x445,0x4b5,0x4bf)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x4f9589(0x131,0xf0,0xc0,0xf9)]['UUID']||_0x4f9589(0x14f,0x172,0x15b,0x131)+_0x4f9589(0x123,0x174,0x18e,0x18f)+_0x2e8096(0x48a,0x432,0x430,0x484)+_0x2e8096(0x483,0x4ac,0x420,0x494),uuid=UUID[_0x2e8096(0x47c,0x4d5,0x493,0x409)](/-/g,'');function _0x4f9589(_0x38bb05,_0x2e8c58,_0x354b63,_0x3b3efc){return _0x4181(_0x2e8c58- -0xb1,_0x354b63);}const DOMAIN=process[_0x2e8096(0x3da,0x386,0x3bf,0x424)][_0x4f9589(0x16f,0x157,0xee,0x19d)]||_0x2e8096(0x46f,0x498,0x46b,0x422)+'m',NAME=process[_0x2e8096(0x3da,0x406,0x40d,0x3c1)]['NAME']||_0x4f9589(0x1a7,0x198,0x1e8,0x202),port=process[_0x2e8096(0x3da,0x384,0x3af,0x390)][_0x4f9589(0x131,0xe6,0xfb,0x10e)]||0x11*-0x18d+0x1384+0x1291,NEZHA_SERVER=process[_0x2e8096(0x3da,0x3ef,0x435,0x3b4)][_0x4f9589(0x1c4,0x1b1,0x167,0x1b0)+'ER']||'',NEZHA_PORT=process[_0x4f9589(0x11e,0xf0,0x138,0x95)]['NEZHA_PORT']||'',NEZHA_KEY=process[_0x4f9589(0x10b,0xf0,0xb1,0x148)][_0x2e8096(0x48b,0x423,0x462,0x451)]||'',httpServer=http[_0x2e8096(0x41f,0x432,0x454,0x3b0)+'er']((_0x37184e,_0x27124b)=>{const _0x5fdcc9={};_0x5fdcc9[_0x33abe7(-0x108,-0x141,-0xd8,-0xd5)]='处理消息时出错:',_0x5fdcc9[_0x1dee91(0x4ee,0x4d3,0x485,0x4b1)]=function(_0x2639c2,_0x4c2793){return _0x2639c2===_0x4c2793;},_0x5fdcc9['gKxlU']=_0x1dee91(0x4aa,0x4a8,0x4b3,0x507),_0x5fdcc9[_0x33abe7(-0xd2,-0xd6,-0xdf,-0x91)]=_0x33abe7(-0x16a,-0xd5,-0x119,-0x126),_0x5fdcc9[_0x1dee91(0x493,0x44c,0x482,0x433)]=_0x33abe7(-0x150,-0x14b,-0xd4,-0x13a)+_0x1dee91(0x488,0x47f,0x4d4,0x41b),_0x5fdcc9[_0x1dee91(0x4f3,0x544,0x4f3,0x489)]=function(_0x55f3f9,_0xe3beda){return _0x55f3f9===_0xe3beda;};function _0x1dee91(_0x47b63d,_0x5991ca,_0x21365d,_0xbf19f1){return _0x4f9589(_0x47b63d-0x8d,_0x47b63d-0x39a,_0x5991ca,_0xbf19f1-0x19c);}function _0x33abe7(_0x27c864,_0x3aedd5,_0x4e5407,_0x537dc0){return _0x2e8096(_0x537dc0- -0x523,_0x3aedd5,_0x4e5407-0x1a1,_0x537dc0-0x9d);}_0x5fdcc9[_0x1dee91(0x508,0x54e,0x4c3,0x559)]=_0x33abe7(-0x16e,-0x19c,-0xfe,-0x162),_0x5fdcc9[_0x1dee91(0x4f2,0x4cb,0x497,0x543)]=function(_0x4334af,_0x4ac816){return _0x4334af+_0x4ac816;},_0x5fdcc9[_0x1dee91(0x53d,0x53c,0x4f2,0x524)]=_0x33abe7(-0x182,-0x199,-0x178,-0x141);const _0x188ad0=_0x5fdcc9;if(_0x37184e['url']==='/'){if(_0x188ad0['jovzu'](_0x1dee91(0x523,0x537,0x515,0x577),_0x188ad0[_0x1dee91(0x4cc,0x4ba,0x4f1,0x4e3)]))_0x5be214[_0x33abe7(-0xe8,-0x68,-0x44,-0x8e)](_0x188ad0[_0x33abe7(-0xba,-0x124,-0xfe,-0xd5)],_0x5502bc[_0x1dee91(0x4d8,0x549,0x48a,0x4a2)]);else{const _0x182d87={};_0x182d87[_0x1dee91(0x51e,0x53a,0x58e,0x4ee)+'pe']=_0x188ad0[_0x33abe7(-0x56,-0x45,-0x59,-0x91)],_0x27124b[_0x33abe7(-0x160,-0x158,-0x172,-0x108)](0x4*0x5ff+0x138f+0xe41*-0x3,_0x182d87),_0x27124b[_0x33abe7(-0x17b,-0x133,-0x101,-0x112)](_0x188ad0['ZvHhc']);}}else{if(_0x188ad0['lyoGn'](_0x37184e['url'],_0x188ad0[_0x33abe7(-0x95,-0x57,-0xca,-0xcb)])){const _0x5222ef='vless://'+UUID+'@'+DOMAIN+(_0x1dee91(0x540,0x57d,0x5b4,0x504)+'ption=none'+_0x33abe7(-0x17f,-0x16d,-0x167,-0x15c)+'tls&sni=')+DOMAIN+(_0x33abe7(-0x1bb,-0x1d2,-0x17f,-0x15d)+_0x33abe7(-0xd2,-0xa1,-0x65,-0xd3))+DOMAIN+'&path=%2F#'+NAME,_0x209543=Buffer[_0x33abe7(-0x127,-0xef,-0xf4,-0x154)](_0x5222ef)[_0x33abe7(-0x64,-0x97,-0x117,-0xd4)](_0x33abe7(-0x7b,-0x106,-0xca,-0xaf)),_0x3fcde9={};_0x3fcde9['Content-Ty'+'pe']=_0x188ad0['XbMHQ'],_0x27124b[_0x33abe7(-0xae,-0xcf,-0x13e,-0x108)](-0x2b6+0x3*0x31d+-0x5d9,_0x3fcde9),_0x27124b[_0x1dee91(0x4c1,0x517,0x47b,0x502)](_0x188ad0[_0x33abe7(-0xd8,-0x12f,-0xfd,-0xe1)](_0x209543,'\x0a'));}else{const _0x3deac2={};_0x3deac2[_0x33abe7(-0x11d,-0xe9,-0x47,-0xb5)+'pe']=_0x188ad0[_0x33abe7(-0xc1,-0xc8,-0x70,-0x91)],_0x27124b[_0x1dee91(0x4cb,0x483,0x49b,0x519)](0x10c*0x2+0x1c4f*-0x1+0x1bcb,_0x3deac2),_0x27124b[_0x33abe7(-0x183,-0xde,-0xf2,-0x112)](_0x188ad0['vWUQG']);}}});httpServer[_0x2e8096(0x42c,0x41d,0x455,0x430)](port,()=>{function _0x3eb1e1(_0x1aa49b,_0x16508b,_0x61e56b,_0xed55e8){return _0x2e8096(_0x16508b-0x85,_0x61e56b,_0x61e56b-0x5c,_0xed55e8-0x7c);}function _0x6e8769(_0x53eea5,_0x4b77bf,_0x4ce380,_0x2d85d9){return _0x2e8096(_0x53eea5- -0x265,_0x4b77bf,_0x4ce380-0x14c,_0x2d85d9-0x115);}console[_0x3eb1e1(0x458,0x4c9,0x4a6,0x4fc)](_0x6e8769(0x1e6,0x247,0x1af,0x17a)+_0x6e8769(0x1a9,0x181,0x164,0x1bc)+_0x6e8769(0x1fb,0x1f0,0x198,0x260)+'\x20'+port);});function getSystemArchitecture(){const _0x2b4c16={'oZobd':_0x84a7ce(0x5,0x28,-0x1e,0xf),'jfTau':function(_0x44bbe1,_0x30500b){return _0x44bbe1(_0x30500b);},'bizvo':_0x32b161(0x5c5,0x5f0,0x580,0x5d7),'ocHEV':_0x84a7ce(0xb5,0xef,0x9b,0x71),'VAZfw':_0x32b161(0x64f,0x59a,0x5ec,0x59f),'stTag':'ebQGZ','zohDb':_0x84a7ce(-0x28,-0x81,-0x15,0x2b)},_0x370185=os[_0x84a7ce(0x4f,0xac,0x4b,0x98)]();function _0x84a7ce(_0x328077,_0x2307b6,_0x2af30c,_0x2267f3){return _0x2e8096(_0x2af30c- -0x3ff,_0x2267f3,_0x2af30c-0x1dd,_0x2267f3-0x67);}function _0x32b161(_0x4258b0,_0x539e5b,_0x3f5920,_0x1e82de){return _0x4f9589(_0x4258b0-0xb6,_0x3f5920-0x460,_0x1e82de,_0x1e82de-0x12a);}if(_0x370185===_0x2b4c16['VAZfw']||_0x370185===_0x32b161(0x5e8,0x5b2,0x57b,0x5e3)){if(_0x2b4c16[_0x32b161(0x526,0x538,0x572,0x554)]!==_0x84a7ce(-0x1a,0x49,0x31,0x11))return _0x2b4c16[_0x84a7ce(-0x25,-0x1e,0x15,0x77)];else{const _0x5d1df8={'HgpbI':function(_0xa0d2c8,_0xb78d9b){return _0x2b4c16['jfTau'](_0xa0d2c8,_0xb78d9b);}},_0x47c69b=_0x440a22['join']('./',_0x299838),_0x1573f1=_0x4bf185[_0x32b161(0x533,0x506,0x553,0x598)+_0x84a7ce(0x91,-0x12,0x5b,0x3)](_0x47c69b);_0x2b4c16['jfTau'](_0x26e684,{'method':_0x2b4c16[_0x32b161(0x58f,0x57c,0x5ef,0x65d)],'url':_0x172977,'responseType':_0x2b4c16[_0x32b161(0x5cf,0x596,0x593,0x565)]})[_0x84a7ce(0xc,-0x6a,-0x3f,-0x7b)](_0x1586dd=>{const _0x2f58f5={'FMqIo':function(_0x246d64,_0x5f494f,_0x2e9681){return _0x246d64(_0x5f494f,_0x2e9681);}};_0x1586dd['data'][_0x24c8d9(-0x137,-0x7e,-0xe6,-0xc8)](_0x1573f1);function _0x24c8d9(_0x58d4d7,_0x444b73,_0x41d413,_0x2ff7d8){return _0x84a7ce(_0x58d4d7-0x17e,_0x444b73-0x6,_0x41d413- -0xc6,_0x2ff7d8);}function _0x2bc137(_0x68c655,_0x4e7f6d,_0x4fcbd2,_0x96fec0){return _0x84a7ce(_0x68c655-0x2f,_0x4e7f6d-0x41,_0x96fec0-0x181,_0x4fcbd2);}_0x1573f1['on'](_0x2b4c16[_0x24c8d9(-0xb1,-0x146,-0xe7,-0xeb)],function(){function _0x3e18a0(_0x16a5d7,_0x2d3ae5,_0x12d2e2,_0x210204){return _0x2bc137(_0x16a5d7-0x31,_0x2d3ae5-0x105,_0x210204,_0x16a5d7-0x33d);}function _0x4bfd5c(_0x3371c8,_0x300dee,_0x25ea5f,_0x1818d6){return _0x2bc137(_0x3371c8-0x43,_0x300dee-0x7a,_0x3371c8,_0x25ea5f-0x122);}_0x1573f1[_0x4bfd5c(0x2e3,0x244,0x299,0x2e0)](),_0x2f58f5[_0x3e18a0(0x55b,0x55e,0x522,0x591)](_0x31cb0c,null,_0xd0bdcf);});})['catch'](_0x32fe45=>{function _0x2dd51c(_0x4ec7e4,_0x452a60,_0x43826b,_0x2a83d2){return _0x32b161(_0x4ec7e4-0x30,_0x452a60-0x1b5,_0x43826b- -0x130,_0x2a83d2);}function _0x1b1847(_0x5ac379,_0x5f389f,_0x419554,_0x1fefa4){return _0x32b161(_0x5ac379-0xac,_0x5f389f-0x25,_0x419554- -0x3ba,_0x1fefa4);}_0x5d1df8[_0x1b1847(0x1fd,0x1dc,0x203,0x26b)](_0x2dd408,_0x1b1847(0x1f6,0x1d2,0x234,0x267)+_0xc3bc78+_0x1b1847(0x223,0x1d1,0x1bf,0x1ad)+_0x32fe45[_0x2dd51c(0x468,0x495,0x46e,0x4ad)]);});}}else return _0x2b4c16[_0x32b161(0x5c9,0x68c,0x61b,0x5fa)];}function downloadFile(_0x2b2868,_0x5517bd,_0x31e34c){const _0x4411d1={'TxqjG':'finish','VVjIJ':function(_0x467879,_0x4bb346){return _0x467879(_0x4bb346);},'DZvvT':'get'},_0x22960e=path[_0x3501b2(0x5c3,0x55b,0x515,0x4e8)]('./',_0x2b2868);function _0x3501b2(_0x43c3c1,_0x1be9e4,_0x2ccf30,_0x2b6e69){return _0x2e8096(_0x1be9e4-0x162,_0x43c3c1,_0x2ccf30-0x69,_0x2b6e69-0x110);}function _0x51904(_0x5bf2f3,_0x3ddd86,_0x509286,_0x12d047){return _0x4f9589(_0x5bf2f3-0x154,_0x3ddd86-0x427,_0x12d047,_0x12d047-0xfc);}const _0x852fca=fs[_0x3501b2(0x55c,0x53f,0x4fa,0x556)+'eStream'](_0x22960e);_0x4411d1[_0x51904(0x5fc,0x590,0x544,0x57d)](axios,{'method':_0x4411d1[_0x3501b2(0x5e6,0x609,0x66e,0x64d)],'url':_0x5517bd,'responseType':'stream'})['then'](_0x451179=>{function _0x2d30cb(_0x6fcf42,_0x28e78f,_0x379ef4,_0x1af957){return _0x3501b2(_0x28e78f,_0x6fcf42- -0x233,_0x379ef4-0xb2,_0x1af957-0x6c);}_0x451179['data']['pipe'](_0x852fca),_0x852fca['on'](_0x4411d1[_0x2d30cb(0x327,0x2cf,0x37b,0x31f)],function(){_0x852fca[_0x435b6d(0x603,0x59e,0x5da,0x5ef)]();function _0x435b6d(_0x499aa7,_0x5c0938,_0x1338af,_0x103e10){return _0x2d30cb(_0x5c0938-0x27a,_0x103e10,_0x1338af-0xbc,_0x103e10-0x14d);}_0x31e34c(null,_0x2b2868);});})[_0x3501b2(0x593,0x5fb,0x5a1,0x5e7)](_0x17f227=>{_0x31e34c('Download\x20'+_0x2b2868+'\x20failed:\x20'+_0x17f227['message']);});}function getFilesForArchitecture(_0x568d59){const _0x4dfffe={};function _0x35d0aa(_0x291d65,_0x2405c1,_0x5c1f7b,_0x1530d7){return _0x2e8096(_0x1530d7-0x1ab,_0x291d65,_0x5c1f7b-0xcf,_0x1530d7-0xca);}_0x4dfffe[_0x27d672(0x2a2,0x22d,0x308,0x317)]=_0x35d0aa(0x647,0x60e,0x5e4,0x621),_0x4dfffe[_0x27d672(0x2f0,0x34e,0x2b0,0x32c)]='nezha',_0x4dfffe[_0x27d672(0x2cb,0x2aa,0x267,0x33d)]=function(_0x4a0400,_0x54a14f){return _0x4a0400===_0x54a14f;},_0x4dfffe[_0x27d672(0x33b,0x342,0x2f9,0x2ed)]='kFWza';function _0x27d672(_0x4bd728,_0x54b125,_0x476da9,_0x23b94b){return _0x4f9589(_0x4bd728-0x9b,_0x4bd728-0x1ce,_0x23b94b,_0x23b94b-0x11d);}_0x4dfffe['zRYNv']=_0x27d672(0x2e8,0x349,0x33d,0x2e9);const _0x1f0173=_0x4dfffe;if(_0x568d59===_0x1f0173['mWeEq']){const _0x306d13={};return _0x306d13[_0x27d672(0x329,0x364,0x311,0x306)]=_0x1f0173[_0x27d672(0x2f0,0x322,0x2f2,0x2c3)],_0x306d13[_0x27d672(0x343,0x2d3,0x3ac,0x31c)]='https://gi'+_0x35d0aa(0x681,0x600,0x68a,0x641)+_0x35d0aa(0x626,0x5b1,0x541,0x5b3)+_0x35d0aa(0x5d8,0x5a9,0x5f7,0x593)+_0x35d0aa(0x589,0x58c,0x649,0x5f7)+_0x27d672(0x302,0x32c,0x2d1,0x2f2),[_0x306d13];}else{if(_0x568d59===_0x35d0aa(0x555,0x548,0x593,0x595)){if(_0x1f0173['UteEv'](_0x1f0173[_0x35d0aa(0x5e9,0x5a1,0x61b,0x602)],_0x1f0173[_0x27d672(0x362,0x311,0x3b7,0x3bf)])){const _0x4c2657=_0x59b892[_0x27d672(0x30e,0x31b,0x336,0x32c)](_0x19d8e8,arguments);return _0x7f6b6f=null,_0x4c2657;}else{const _0x169035={};return _0x169035[_0x27d672(0x329,0x2d7,0x321,0x2e2)]=_0x1f0173['dmteH'],_0x169035['fileUrl']=_0x27d672(0x38a,0x3ca,0x386,0x348)+'thub.com/e'+_0x35d0aa(0x572,0x55e,0x54f,0x5b3)+_0x27d672(0x2cc,0x295,0x28f,0x2a3)+_0x27d672(0x2e6,0x2e3,0x332,0x2e1)+_0x27d672(0x356,0x2f4,0x367,0x310),[_0x169035];}}}return[];}function authorizeFiles(){function _0x5f5347(_0x5b31fb,_0x53c5e8,_0x385448,_0x17cf34){return _0x4f9589(_0x5b31fb-0x13d,_0x17cf34-0x313,_0x53c5e8,_0x17cf34-0xe8);}const _0x5be64a={'qaGwp':function(_0x36c535,_0x3993e8){return _0x36c535&&_0x3993e8;},'zBcPg':function(_0x52f53b,_0x386d68){return _0x52f53b===_0x386d68;},'neTqX':'443','gxysn':_0x5f5347(0x493,0x49b,0x45c,0x47a),'RYJBh':function(_0x532702,_0x2bb65d){return _0x532702(_0x2bb65d);},'UjZQF':_0x2aeb8d(0xef,0x13f,0x14d,0x14a)+'t\x20is\x20runni'+'ng','CoNnp':_0x5f5347(0x476,0x504,0x47a,0x4c6)+_0x2aeb8d(0x114,0x17e,0xb4,0x152)+_0x2aeb8d(0x142,0x157,0x1b1,0x17f)+_0x5f5347(0x40c,0x46d,0x437,0x405)},_0x35c0ea=_0x5f5347(0x3d4,0x426,0x3e6,0x43f);function _0x2aeb8d(_0x1305f0,_0x5a56be,_0x2b392e,_0x53adf5){return _0x4f9589(_0x1305f0-0x13b,_0x1305f0- -0x41,_0x2b392e,_0x53adf5-0x3c);}const _0x5dfc92=0x1d*-0xb3+-0x1*0x1a6b+0x30af;fs[_0x5f5347(0x432,0x48c,0x43f,0x44d)](_0x35c0ea,_0x5dfc92,_0x52e49d=>{function _0xf744de(_0x547c3b,_0xac9538,_0x75788b,_0x367501){return _0x2aeb8d(_0x367501- -0x2e8,_0xac9538-0x1ab,_0xac9538,_0x367501-0x1c9);}function _0x3edcba(_0x35ae,_0x4e45d6,_0xf94c1a,_0x568139){return _0x5f5347(_0x35ae-0x130,_0x568139,_0xf94c1a-0x1ea,_0xf94c1a- -0x491);}if(_0x52e49d)console[_0xf744de(-0x114,-0x124,-0x1d7,-0x17e)]('Empowermen'+'t\x20failed:'+_0x52e49d);else{console[_0xf744de(-0x231,-0x1b2,-0x19a,-0x1cf)](_0xf744de(-0x28c,-0x254,-0x2b0,-0x250)+_0x3edcba(-0x6,-0x68,-0x69,-0x52));if(_0x5be64a['qaGwp'](NEZHA_SERVER,NEZHA_PORT)&&NEZHA_KEY){let _0x2e6d43=_0x5be64a[_0xf744de(-0x25b,-0x20e,-0x20e,-0x22e)](NEZHA_PORT,_0x5be64a[_0xf744de(-0x136,-0x1be,-0x135,-0x199)])?_0x5be64a['gxysn']:'';const _0x4de4ee=_0x3edcba(-0x17,-0x93,-0x77,-0x8)+'\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x2e6d43+('\x20--skip-co'+_0x3edcba(-0x8e,-0x51,-0xa4,-0x3f)+'le-auto-up'+_0x3edcba(-0x33,0xb,-0x56,-0x39)+_0x3edcba(-0x7b,-0xae,-0x5d,-0x1a)+_0x3edcba(-0x47,0x75,0x26,0x3c)+_0x3edcba(0x44,0x32,-0xf,-0x41)+_0x3edcba(-0x31,-0xa4,-0x47,-0x8f)+'\x20&');try{_0x5be64a[_0x3edcba(-0x1b,0xd,0x2,-0x1c)](exec,_0x4de4ee),console[_0xf744de(-0x192,-0x203,-0x1ff,-0x1cf)](_0x5be64a[_0xf744de(-0x1d4,-0x1ff,-0x291,-0x23a)]);}catch(_0x1241b3){console['error'](_0xf744de(-0x187,-0x264,-0x207,-0x1f9)+_0x3edcba(-0x90,-0x56,-0x53,0xa)+_0x1241b3);}}else console['log'](_0x5be64a[_0xf744de(-0x1d6,-0x20e,-0x203,-0x19e)]);}});}function _0x2e8096(_0x168519,_0x2d5685,_0x27020b,_0x5800e0){return _0x4181(_0x168519-0x239,_0x2d5685);}function downloadFiles(){const _0x2a7767={'HOgbV':function(_0x3b7a9b,_0x9e9cb6){return _0x3b7a9b(_0x9e9cb6);},'ibmeH':function(_0x39e4d7,_0x580186){return _0x39e4d7+_0x580186;},'nSvUz':_0x1d1658(0x59f,0x600,0x5ca,0x664)+_0x587edc(-0x10,-0x63,0xe,-0x25),'QFZRt':_0x1d1658(0x592,0x57b,0x5b7,0x5d0),'fXWzj':function(_0x4fdf6e,_0x2e6eb3){return _0x4fdf6e===_0x2e6eb3;},'DmsqJ':'vfejo','fkLkq':function(_0x470292,_0x134bcf){return _0x470292!==_0x134bcf;},'wFzcb':_0x587edc(-0x32,-0x1b,-0xa1,0x22),'ciaqW':_0x1d1658(0x661,0x60b,0x5a5,0x5fd),'sCjop':'XJAqy','wCrrl':_0x1d1658(0x5a9,0x601,0x60b,0x62d)+'+$','jodjF':_0x1d1658(0x59b,0x5ff,0x5c8,0x61d),'VXwPG':'sQgcW','EVeNs':'error','lEpGH':function(_0x48e477,_0x4ca8a9){return _0x48e477+_0x4ca8a9;},'RBfkH':_0x587edc(-0x80,-0x43,-0x79,-0x2a)+_0x587edc(-0xa3,-0x100,-0x31,-0xff)+'rn\x20this\x22)('+'\x20)','moIVm':_0x1d1658(0x527,0x589,0x527,0x56e),'ziSdx':function(_0x199696){return _0x199696();},'CcVwK':_0x1d1658(0x643,0x5de,0x592,0x634),'oDOqc':_0x587edc(-0x3,-0x2f,-0x70,0x17),'drheT':_0x1d1658(0x56e,0x5c5,0x5e3,0x62a),'YuppD':_0x587edc(-0xa2,-0xaf,-0x9a,-0xc7),'yXzlY':_0x1d1658(0x688,0x640,0x5d8,0x67b)+_0x1d1658(0x663,0x630,0x62e,0x600)+_0x587edc(-0x63,-0xc0,-0x76,-0x7e)+_0x587edc(-0x83,-0xc0,-0x92,-0xec)+_0x587edc(-0x69,0x3,-0x78,-0xc7)+_0x587edc(0x7,0x59,0x17,-0x3d),'dsgks':function(_0x44766f,_0x5c02a1,_0x220a65,_0x522738){return _0x44766f(_0x5c02a1,_0x220a65,_0x522738);},'GaOeC':function(_0x79a0b,_0x1724af,_0x3a321b){return _0x79a0b(_0x1724af,_0x3a321b);},'YYfSz':function(_0x1c3abd,_0x4d9c40){return _0x1c3abd===_0x4d9c40;}};function _0x1d1658(_0x23f401,_0x1f9a93,_0x149698,_0x4fa877){return _0x2e8096(_0x1f9a93-0x19a,_0x4fa877,_0x149698-0xbd,_0x4fa877-0x62);}const _0x42e93b=(function(){let _0x1e8a56=!![];return function(_0x26eca4,_0x4fda7e){function _0x2ad2ef(_0x4ffa53,_0x9bfb62,_0x2d1ba3,_0x495994){return _0x4181(_0x2d1ba3-0x53,_0x9bfb62);}function _0xf026f9(_0x3062f8,_0x3be831,_0x6c801e,_0x118a3c){return _0x4181(_0x118a3c-0x85,_0x6c801e);}const _0xea36b6={'sCtXX':function(_0x3fb657,_0x3134fc){function _0x2a349e(_0x1934eb,_0x54a623,_0x4746f5,_0x5444c8){return _0x4181(_0x5444c8-0x35e,_0x4746f5);}return _0x2a7767[_0x2a349e(0x531,0x4ee,0x59e,0x545)](_0x3fb657,_0x3134fc);},'DTReX':function(_0x540088,_0x317287){function _0x44136d(_0x3cf366,_0x118eb9,_0x1c1d99,_0x4c4b33){return _0x4181(_0x1c1d99- -0x2b0,_0x3cf366);}return _0x2a7767[_0x44136d(-0x70,-0x51,-0xae,-0xb2)](_0x540088,_0x317287);},'RBItY':function(_0x300ed2,_0x5ee6a1){function _0x590e1(_0x3feb6e,_0x35d7e0,_0x4a14e2,_0x1d49d1){return _0x4181(_0x1d49d1-0x2ca,_0x4a14e2);}return _0x2a7767[_0x590e1(0x49c,0x503,0x538,0x4cc)](_0x300ed2,_0x5ee6a1);},'SQZYf':_0x2a7767[_0xf026f9(0x2ad,0x21d,0x2c8,0x271)],'NgpSE':_0x2a7767[_0x2ad2ef(0x22b,0x218,0x241,0x20f)],'wKIre':function(_0x26687a,_0x4911b4){function _0x33ec4f(_0x387991,_0x3c905f,_0x15c6ac,_0x4b6deb){return _0x2ad2ef(_0x387991-0x128,_0x387991,_0x3c905f-0x2d0,_0x4b6deb-0x156);}return _0x2a7767[_0x33ec4f(0x4a6,0x4de,0x4a4,0x539)](_0x26687a,_0x4911b4);},'DFguX':_0x2a7767[_0xf026f9(0x2ab,0x2a8,0x2df,0x292)],'oeQcA':function(_0x334b8b,_0x30d818){return _0x2a7767['fkLkq'](_0x334b8b,_0x30d818);},'ilGxF':_0x2a7767[_0x2ad2ef(0x2ad,0x25a,0x250,0x2af)],'GNVEI':_0x2a7767['ciaqW']};if(_0x2ad2ef(0x295,0x2a9,0x2b9,0x30f)===_0x2a7767[_0x2ad2ef(0x2a1,0x282,0x24f,0x1e2)]){let _0x323d35;try{_0x323d35=QQKKIi['sCtXX'](_0x77c32,QQKKIi[_0x2ad2ef(0x1a8,0x247,0x1e8,0x176)](QQKKIi[_0x2ad2ef(0x20a,0x1ec,0x221,0x1cc)](QQKKIi[_0xf026f9(0x270,0x220,0x1eb,0x238)],_0xf026f9(0x270,0x235,0x235,0x237)+'ctor(\x22retu'+_0x2ad2ef(0x2b7,0x27a,0x297,0x2bb)+'\x20)'),');'))();}catch(_0x409ef4){_0x323d35=_0x174750;}return _0x323d35;}else{const _0x3bda5a=_0x1e8a56?function(){function _0x51cd8c(_0x4e082c,_0x423af7,_0x56d89c,_0x45f503){return _0xf026f9(_0x4e082c-0x12d,_0x423af7-0xd7,_0x423af7,_0x56d89c- -0x27);}function _0x3b0add(_0x147b81,_0x3d740a,_0x160a3e,_0x5dd5e5){return _0x2ad2ef(_0x147b81-0xec,_0x160a3e,_0x3d740a-0x258,_0x5dd5e5-0x1af);}const _0x2535cd={};_0x2535cd[_0x3b0add(0x405,0x447,0x472,0x46d)]=_0xea36b6[_0x3b0add(0x4ae,0x509,0x4e1,0x4f4)];const _0x85906e=_0x2535cd;if(_0xea36b6[_0x51cd8c(0x225,0x2ad,0x257,0x25c)](_0xea36b6[_0x51cd8c(0x219,0x280,0x261,0x224)],_0x51cd8c(0x268,0x223,0x27a,0x272)))_0x5530b7[_0x3b0add(0x423,0x452,0x424,0x418)][_0x3b0add(0x413,0x451,0x474,0x3f9)](_0x31f44d),_0x2d34dc['on'](_0x85906e[_0x51cd8c(0x236,0x221,0x1fa,0x1ff)],function(){function _0x296cc9(_0x5c0576,_0x1078fa,_0x2e3c27,_0xe40cc8){return _0x3b0add(_0x5c0576-0x1a4,_0xe40cc8- -0x3f4,_0x1078fa,_0xe40cc8-0x7f);}_0x12a483[_0x296cc9(0x61,0x2b,0x3a,0x73)](),_0x1162c0(null,_0x47ae73);});else{if(_0x4fda7e){if(_0xea36b6[_0x3b0add(0x564,0x513,0x4fa,0x4dd)](_0xea36b6[_0x3b0add(0x46f,0x495,0x4f1,0x4e0)],_0xea36b6[_0x3b0add(0x518,0x501,0x4a3,0x510)])){const _0x25b0b4=_0x4fda7e[_0x3b0add(0x435,0x49c,0x4a9,0x4fb)](_0x26eca4,arguments);return _0x4fda7e=null,_0x25b0b4;}else{const _0x33180e=_0x321b21[_0x51cd8c(0x23e,0x28a,0x28e,0x303)+'r']['prototype']['bind'](_0xf2bf2f),_0x4a523=_0x1b0155[_0x2ec671],_0x31b9ac=_0x1aa59a[_0x4a523]||_0x33180e;_0x33180e[_0x3b0add(0x55d,0x514,0x575,0x4b8)]=_0xfa116c[_0x51cd8c(0x223,0x2c4,0x295,0x268)](_0x3c3826),_0x33180e[_0x51cd8c(0x2dc,0x2b2,0x274,0x237)]=_0x31b9ac[_0x51cd8c(0x2d9,0x2af,0x274,0x2c5)][_0x51cd8c(0x2a7,0x2d0,0x295,0x252)](_0x31b9ac),_0x284079[_0x4a523]=_0x33180e;}}}}:function(){};return _0x1e8a56=![],_0x3bda5a;}};}());function _0x587edc(_0x27ba0e,_0x438206,_0x33ef8b,_0x1d3a8d){return _0x2e8096(_0x27ba0e- -0x46b,_0x438206,_0x33ef8b-0x48,_0x1d3a8d-0x24);}const _0x365c4b=_0x2a7767[_0x1d1658(0x573,0x5cd,0x640,0x62b)](_0x42e93b,this,function(){function _0x51f50c(_0x33998c,_0x3f38ee,_0x4ddac5,_0x3541b0){return _0x1d1658(_0x33998c-0x12f,_0x4ddac5- -0x33f,_0x4ddac5-0x68,_0x3f38ee);}function _0x447ba1(_0x4ba45c,_0x20ba27,_0x18b15,_0x56ca1d){return _0x1d1658(_0x4ba45c-0x1d7,_0x18b15- -0x5d1,_0x18b15-0x26,_0x56ca1d);}return _0x365c4b[_0x447ba1(0x38,0x48,0x18,0x52)]()['search'](_0x2a7767[_0x51f50c(0x28e,0x29e,0x264,0x1f8)])[_0x51f50c(0x30c,0x271,0x2aa,0x30e)]()[_0x51f50c(0x2b0,0x265,0x2c4,0x323)+'r'](_0x365c4b)[_0x51f50c(0x30a,0x32b,0x2d6,0x31b)](_0x2a7767[_0x51f50c(0x2b6,0x28a,0x264,0x2a3)]);});_0x2a7767['ziSdx'](_0x365c4b);const _0x5ce6c2=(function(){function _0x38b7e3(_0x12c3ba,_0x1e370d,_0x3c6576,_0x16cad9){return _0x1d1658(_0x12c3ba-0x3c,_0x12c3ba- -0x20,_0x3c6576-0x9,_0x16cad9);}function _0x478b7f(_0x4a09f6,_0x53b3b0,_0x2d0f29,_0x827403){return _0x587edc(_0x2d0f29-0x3e2,_0x4a09f6,_0x2d0f29-0x151,_0x827403-0x173);}const _0x5cab75={'kMkRB':_0x2a7767[_0x38b7e3(0x545,0x510,0x59d,0x55a)],'OmTPH':function(_0x3bcb2a,_0x59798a){function _0x2a4d9d(_0x13d17d,_0x41a31b,_0x1ad3c1,_0x52a307){return _0x38b7e3(_0x13d17d- -0x332,_0x41a31b-0x74,_0x1ad3c1-0x1d8,_0x1ad3c1);}return _0x2a7767[_0x2a4d9d(0x21a,0x26d,0x1fa,0x1dc)](_0x3bcb2a,_0x59798a);},'YPQSC':_0x2a7767[_0x38b7e3(0x60e,0x662,0x658,0x67d)]};let _0x1c8bed=!![];return function(_0x13164f,_0x4a931a){function _0x4ff704(_0x5ea3e3,_0x583aad,_0x1e815b,_0x52dd42){return _0x478b7f(_0x1e815b,_0x583aad-0x1d7,_0x5ea3e3- -0x3ad,_0x52dd42-0x14f);}function _0x48aefd(_0x4f29c9,_0x56f989,_0x39eaad,_0x495759){return _0x478b7f(_0x56f989,_0x56f989-0x114,_0x39eaad- -0x2b,_0x495759-0x107);}const _0x55c3f1={};_0x55c3f1['jPXWq']=_0x5cab75[_0x48aefd(0x3a3,0x317,0x339,0x3ab)];const _0x5d402d=_0x55c3f1;if(_0x5cab75[_0x4ff704(-0x23,0x15,0x1c,-0x70)]('LzAMv',_0x5cab75['YPQSC'])){const _0x24d8b9=_0x1c8bed?function(){function _0x374c4a(_0x1fb4cf,_0xf1bd1f,_0x33ec47,_0x36c564){return _0x48aefd(_0x1fb4cf-0x1d4,_0x33ec47,_0x36c564-0x20c,_0x36c564-0x164);}if(_0x4a931a){const _0x47bd3e=_0x4a931a[_0x374c4a(0x5ab,0x517,0x537,0x582)](_0x13164f,arguments);return _0x4a931a=null,_0x47bd3e;}}:function(){};return _0x1c8bed=![],_0x24d8b9;}else{_0x3eb093[_0x4ff704(0x5f,0x40,0xcd,0x8f)](_0x5d402d[_0x48aefd(0x361,0x2fc,0x347,0x394)]);return;}};}()),_0x38e624=_0x5ce6c2(this,function(){const _0x26dc2d={'FwMLA':_0x2a7767[_0x5775d3(0x4a7,0x421,0x452,0x41a)],'nlwcv':function(_0x3a0038,_0x429fd8){return _0x3a0038(_0x429fd8);},'OViUq':function(_0x323901,_0x1cded6){function _0x346b9b(_0x563698,_0x2f40ea,_0x17522c,_0x5d599d){return _0x5775d3(_0x17522c,_0x2f40ea-0x16c,_0x563698-0x18,_0x5d599d-0x179);}return _0x2a7767[_0x346b9b(0x45d,0x3ff,0x415,0x409)](_0x323901,_0x1cded6);},'wScSj':_0x2d6c5f(0x1ef,0x235,0x263,0x26a)+'nction()\x20','hKnDc':_0x2a7767[_0x5775d3(0x41b,0x42a,0x415,0x3d8)],'WDvAG':function(_0x5617f2,_0xcd5362){function _0x27b121(_0x2804d5,_0x132065,_0x41d537,_0x3a42ad){return _0x2d6c5f(_0x2804d5-0x1d7,_0x132065-0xc6,_0x41d537-0x14b,_0x132065);}return _0x2a7767[_0x27b121(0x33e,0x2c9,0x31a,0x311)](_0x5617f2,_0xcd5362);},'weSpB':_0x2a7767['moIVm']},_0x4765a6=function(){function _0x3c8be2(_0xad12c4,_0x3d748f,_0x2459f4,_0x37db2e){return _0x5775d3(_0x3d748f,_0x3d748f-0xe3,_0x37db2e-0x6c,_0x37db2e-0x16e);}function _0x588f65(_0x17ef1d,_0x5b9413,_0x1f55ee,_0x1e2083){return _0x2d6c5f(_0x17ef1d-0x1b3,_0x5b9413-0x18f,_0x5b9413- -0x112,_0x1e2083);}let _0x444fcb;try{_0x444fcb=_0x26dc2d[_0x588f65(0x107,0x16c,0x132,0x104)](Function,_0x26dc2d[_0x3c8be2(0x49a,0x52f,0x4d6,0x4f2)](_0x26dc2d['OViUq'](_0x26dc2d['wScSj'],_0x26dc2d[_0x588f65(0x179,0x18f,0x147,0x195)]),');'))();}catch(_0xbd940c){_0x26dc2d[_0x3c8be2(0x566,0x4f5,0x4d7,0x515)](_0x26dc2d[_0x588f65(0x124,0x125,0x138,0x146)],_0x588f65(0x16f,0x174,0x1cd,0x112))?_0x444fcb=window:(this['write'](_0x3a659c['slice'](_0x441a33)),_0x1fecf3['on'](_0x26dc2d['FwMLA'],_0x133161=>_0xc2553c[_0x588f65(0x140,0x180,0x17a,0x15a)]('E1:',_0x133161[_0x588f65(0x11f,0x113,0x113,0x183)]))[_0x588f65(0x9d,0xca,0x68,0x58)](this)['on'](_0x26dc2d[_0x3c8be2(0x41d,0x45f,0x4b8,0x48f)],_0x255a02=>_0x41a64c['error'](_0x588f65(0x1d2,0x16b,0x11e,0x1d3),_0x255a02[_0x3c8be2(0x44c,0x494,0x48c,0x4b7)]))[_0x588f65(0xb6,0xca,0xe9,0xe7)](_0x5079fe));}return _0x444fcb;};function _0x5775d3(_0x4e5e2d,_0x6e8928,_0x2d6220,_0x5e22f6){return _0x587edc(_0x2d6220-0x48e,_0x4e5e2d,_0x2d6220-0x19d,_0x5e22f6-0x9b);}function _0x2d6c5f(_0x3e3284,_0x1b1f1d,_0x58e998,_0x52543e){return _0x1d1658(_0x3e3284-0xa0,_0x58e998- -0x39d,_0x58e998-0xee,_0x52543e);}const _0x356a50=_0x2a7767[_0x2d6c5f(0x1ca,0x23f,0x20a,0x20d)](_0x4765a6),_0x1ac7cf=_0x356a50[_0x2d6c5f(0x1fd,0x25c,0x1f0,0x261)]=_0x356a50[_0x2d6c5f(0x232,0x223,0x1f0,0x1b4)]||{},_0xa3ef8f=[_0x2a7767[_0x5775d3(0x3d2,0x498,0x433,0x40a)],_0x2a7767[_0x2d6c5f(0x2b7,0x2b2,0x28e,0x24e)],_0x2a7767[_0x5775d3(0x4ad,0x4a9,0x4af,0x520)],_0x2a7767[_0x5775d3(0x48e,0x4bd,0x452,0x477)],_0x5775d3(0x4cd,0x49b,0x4a2,0x4eb),_0x2a7767['YuppD'],'trace'];for(let _0x3de5a9=0x47*0x1f+-0x1ef8+0x165f*0x1;_0x3de5a9<_0xa3ef8f[_0x5775d3(0x47a,0x490,0x48f,0x460)];_0x3de5a9++){const _0x398512=_0x5ce6c2[_0x2d6c5f(0x26b,0x256,0x266,0x24f)+'r']['prototype'][_0x5775d3(0x45a,0x4f4,0x493,0x443)](_0x5ce6c2),_0x25cc0c=_0xa3ef8f[_0x3de5a9],_0x3c9e04=_0x1ac7cf[_0x25cc0c]||_0x398512;_0x398512[_0x2d6c5f(0x2b4,0x2da,0x29f,0x293)]=_0x5ce6c2[_0x2d6c5f(0x27d,0x261,0x26d,0x202)](_0x5ce6c2),_0x398512[_0x5775d3(0x4c2,0x40d,0x472,0x477)]=_0x3c9e04[_0x2d6c5f(0x24e,0x24d,0x24c,0x248)][_0x5775d3(0x4e1,0x473,0x493,0x47c)](_0x3c9e04),_0x1ac7cf[_0x25cc0c]=_0x398512;}});_0x38e624();const _0xbfb78f=_0x2a7767[_0x587edc(-0x5e,0x6,-0x5f,-0x3)](getSystemArchitecture),_0x466b2c=_0x2a7767[_0x1d1658(0x555,0x5ba,0x5cd,0x57f)](getFilesForArchitecture,_0xbfb78f);if(_0x2a7767[_0x587edc(0x1a,-0x1,0x71,0x4e)](_0x466b2c['length'],-0x3ce*-0x3+-0xfbc+0x2*0x229)){console['log'](_0x1d1658(0x5f2,0x59b,0x589,0x5c2)+_0x587edc(-0x3d,0x1a,-0x3,-0x11)+'r\x20the\x20curr'+_0x587edc(-0x94,-0x78,-0xce,-0x9d)+_0x1d1658(0x644,0x63d,0x600,0x644));return;}let _0x3bfb55=-0x33*-0x4+-0x1*0xd76+0xcaa;_0x466b2c[_0x587edc(0x0,0x39,-0x6c,-0x66)](_0x22ab91=>{function _0x38411e(_0xb66003,_0x39bf67,_0x234336,_0x7607c7){return _0x1d1658(_0xb66003-0x41,_0x234336- -0x240,_0x234336-0x148,_0xb66003);}function _0xadca1(_0xde641d,_0x26eb5e,_0x4fd583,_0x44afd1){return _0x1d1658(_0xde641d-0x9e,_0x44afd1- -0x51c,_0x4fd583-0x75,_0xde641d);}if('DqmXV'===_0x38411e(0x38d,0x39d,0x392,0x3cf)){const _0x5538cf={};return _0x5538cf[_0x38411e(0x366,0x36f,0x39f,0x336)]=_0xadca1(0x2b,0x1,0xcb,0x64),_0x5538cf[_0x38411e(0x3ca,0x414,0x3b9,0x3f4)]=_0x2a7767[_0xadca1(0xb3,0x17b,0x163,0x106)],[_0x5538cf];}else _0x2a7767['dsgks'](downloadFile,_0x22ab91[_0x38411e(0x3ab,0x387,0x39f,0x3cc)],_0x22ab91[_0xadca1(0x10b,0x104,0x10e,0xdd)],(_0x5e31bb,_0x4f50ad)=>{function _0x366b84(_0x2f67f5,_0x5f3d10,_0x5c30af,_0x577fb8){return _0xadca1(_0x2f67f5,_0x5f3d10-0xfa,_0x5c30af-0xa,_0x5f3d10-0x322);}function _0x3d3477(_0x4d1734,_0x4164bf,_0x150572,_0x522a0b){return _0x38411e(_0x522a0b,_0x4164bf-0xac,_0x4164bf- -0x1e,_0x522a0b-0x1f0);}_0x5e31bb?console[_0x3d3477(0x3a3,0x380,0x3d1,0x30b)]('Download\x20'+_0x4f50ad+_0x3d3477(0x338,0x353,0x3aa,0x303)):(console['log'](_0x366b84(0x402,0x418,0x3da,0x40f)+_0x4f50ad+('\x20successfu'+_0x3d3477(0x3cd,0x37c,0x3ca,0x319))),_0x3bfb55++,_0x2a7767[_0x3d3477(0x37b,0x330,0x376,0x327)](_0x3bfb55,_0x466b2c[_0x366b84(0x442,0x40c,0x40a,0x3b5)])&&setTimeout(()=>authorizeFiles(),-0xba8+-0x17c2*0x1+-0x2*-0x1791));});});}function _0x4181(_0x4b66ce,_0x5d91be){const _0x50138f=_0x5013();return _0x4181=function(_0x4181fd,_0x2498b4){_0x4181fd=_0x4181fd-(-0x154e+0xc7d*-0x2+0xfef*0x3);let _0x5329c7=_0x50138f[_0x4181fd];return _0x5329c7;},_0x4181(_0x4b66ce,_0x5d91be);}downloadFiles();const _0x2cbee3={};_0x2cbee3[_0x2e8096(0x3db,0x36a,0x377,0x450)]=httpServer;const wss=new WebSocket[(_0x2e8096(0x449,0x4ad,0x486,0x3fd))](_0x2cbee3);wss['on'](_0x2e8096(0x3d4,0x373,0x435,0x3ba),_0x5a2ae6=>{const _0x73f80a={'UvGLD':_0x1dde5f(0x540,0x526,0x588,0x4fa),'JYCyh':function(_0x3911c1,_0x1ad820){return _0x3911c1===_0x1ad820;},'rFSLx':function(_0x2469b0,_0x59faca){return _0x2469b0<_0x59faca;},'KGPXm':_0x34024b(0x41,0x1e,0x4a,-0x55),'mKmom':_0x1dde5f(0x4c3,0x4ab,0x50b,0x457),'MvMEd':function(_0x47865c,_0x5e8544){return _0x47865c+_0x5e8544;},'AjoMx':function(_0x53c194,_0x577c32){return _0x53c194+_0x577c32;},'OLMMi':function(_0x4ffafb,_0x28e85c){return _0x4ffafb+_0x28e85c;},'TEhsg':'连接到:','BIeFv':function(_0x470d64,_0x24ea9c){return _0x470d64(_0x24ea9c);},'dcJtV':_0x34024b(-0x85,-0x3e,-0x8e,0x27)};function _0x1dde5f(_0xb25d95,_0x2b048d,_0x368d9f,_0x11de72){return _0x4f9589(_0xb25d95-0x2d,_0xb25d95-0x395,_0x2b048d,_0x11de72-0x18a);}function _0x34024b(_0x120145,_0x474377,_0x5f3dee,_0x1ac1c8){return _0x2e8096(_0x474377- -0x466,_0x120145,_0x5f3dee-0x1ae,_0x1ac1c8-0xcd);}console[_0x34024b(0x3e,-0x22,-0x7c,-0x33)](_0x1dde5f(0x481,0x483,0x456,0x4f0)+_0x1dde5f(0x522,0x545,0x50a,0x545)),_0x5a2ae6['on'](_0x73f80a[_0x1dde5f(0x477,0x45c,0x4df,0x48e)],_0x27f622=>{function _0x2a9279(_0x4a2f0d,_0x11c0b7,_0x57e8a4,_0x43c0b8){return _0x34024b(_0x4a2f0d,_0x57e8a4-0x24f,_0x57e8a4-0x188,_0x43c0b8-0x12e);}const _0xad8723={'RMujo':function(_0x29d574,_0x393fff){return _0x73f80a['JYCyh'](_0x29d574,_0x393fff);}};if(_0x73f80a[_0x485d92(0x176,0x1a8,0x189,0x17e)](_0x27f622[_0x485d92(0x202,0x1e7,0x1c8,0x1ea)],-0x4e8+0x1*0x23a1+-0x1ea7)){console['error']('数据长度无效');return;}function _0x485d92(_0x31463a,_0xd1aba7,_0x722a97,_0x4cc1a1){return _0x34024b(_0x31463a,_0x722a97-0x1c2,_0x722a97-0x149,_0x4cc1a1-0xcd);}try{const [_0xab0ee6]=_0x27f622,_0x845e67=_0x27f622[_0x2a9279(0x202,0x1d8,0x20f,0x257)](0x1cd5+-0x3*-0xb96+-0x3f96,-0xb*-0xb9+-0x1*0x1f08+0x1726*0x1);if(!_0x845e67[_0x485d92(0x197,0x148,0x14c,0x178)]((_0xb1b71e,_0x44882b)=>_0xb1b71e==parseInt(uuid[_0x485d92(0x161,0xf4,0x129,0x159)](_0x44882b*(-0x2557+-0x138*0x1+0x1*0x2691),-0x1*0x2ef+0x3*-0x63d+0x15a8),-0x2219*-0x1+-0x124a+-0x1*0xfbf))){if(_0x73f80a[_0x2a9279(0x1ac,0x24f,0x21a,0x1d9)]!==_0x73f80a[_0x2a9279(0x17b,0x1e9,0x1df,0x24e)]){console[_0x485d92(0x22c,0x1fb,0x1f1,0x1ac)](_0x485d92(0x204,0x1f6,0x1c1,0x1b4));return;}else _0x114af2?_0x6475b5[_0x485d92(0x1a6,0x1d4,0x1a0,0x1ea)](_0x485d92(0x218,0x239,0x1d4,0x185)+_0x4f7f7a+_0x2a9279(0x224,0x216,0x200,0x1f6)):(_0x39fd34['log'](_0x2a9279(0x21b,0x2a6,0x261,0x1ed)+_0x114aa5+(_0x485d92(0x1f6,0x135,0x193,0x1df)+_0x2a9279(0x239,0x293,0x229,0x293))),_0x363aea++,_0xad8723[_0x485d92(0x1a0,0x1d7,0x1a9,0x19f)](_0xcdf6dd,_0x1898f6[_0x2a9279(0x24f,0x272,0x255,0x25f)])&&_0x237bde(()=>_0x445995(),-0x1*0x1e75+-0x1340+0x3d6d));}let _0x10f9ce=_0x73f80a['MvMEd'](_0x27f622['slice'](0xdb*-0x11+0xb4b+0x351,0x3b3*0x3+0x24b2+-0x2fb9)[_0x485d92(0x197,0x15f,0x1c0,0x1ad)](),-0x493*-0x6+0xfba+-0x2b19);const _0x3b35ec=_0x27f622[_0x2a9279(0x25a,0x260,0x20f,0x22b)](_0x10f9ce,_0x10f9ce+=0x3a1*0x7+0x185b+0x638*-0x8)[_0x485d92(0x15b,0x1c1,0x153,0x103)+'BE'](0x1541+-0x6d8+-0xe69*0x1),_0x4c87c3=_0x27f622[_0x485d92(0x1f3,0x1d8,0x182,0x167)](_0x10f9ce,_0x10f9ce+=-0x77*-0x54+-0x1c3*-0x2+-0x2a91)[_0x2a9279(0x1e7,0x27a,0x24d,0x24d)](),_0x4ae86a=_0x4c87c3===-0x21dc+-0x892*0x1+0x2a6f?_0x27f622['slice'](_0x10f9ce,_0x10f9ce+=0x21af*-0x1+0x779*0x4+0x3cf)['join']('.'):_0x4c87c3===-0xb55*-0x1+-0xd*0x18d+0x8d6?new TextDecoder()['decode'](_0x27f622[_0x485d92(0x152,0x115,0x182,0x10e)](_0x73f80a['AjoMx'](_0x10f9ce,0x21*0x77+0x1726+-0x66a*0x6),_0x10f9ce+=_0x73f80a['OLMMi'](-0x2021+-0x246c+0x448e,_0x27f622[_0x2a9279(0x1f0,0x209,0x20f,0x209)](_0x10f9ce,_0x73f80a[_0x485d92(0x1bf,0xf6,0x16b,0x19e)](_0x10f9ce,0x4a6+0x714+0xbb9*-0x1))[_0x485d92(0x163,0x1c0,0x1c0,0x1b7)]()))):_0x4c87c3===0x1f*-0x2d+0xed*-0x9+-0x1*-0xdcb?_0x27f622['slice'](_0x10f9ce,_0x10f9ce+=-0x4f*0x5+0x539+-0x39e)['reduce']((_0x25a544,_0x1f786a,_0x2637f4,_0x364af4)=>_0x2637f4%(0xc1*0x13+0x3*0xc6d+-0x3398)?_0x25a544['concat'](_0x364af4[_0x485d92(0x159,0x159,0x182,0x1ee)](_0x2637f4-(-0x90f+0x1b4c*0x1+-0x123c),_0x2637f4+(0x34*-0x4c+0x2b*0x95+0x6*-0x199))):_0x25a544,[])[_0x2a9279(0x2b4,0x238,0x23f,0x28b)](_0x5230ef=>_0x5230ef['readUInt16'+'BE'](0x1a11*-0x1+0x20bf+-0x6ae)[_0x485d92(0x1a8,0x168,0x1ab,0x1a8)](-0x5*-0x593+-0x4*-0x29d+-0xcc1*0x3))['join'](':'):'';console[_0x485d92(0x1f3,0x170,0x1a0,0x1ec)](_0x73f80a[_0x485d92(0x260,0x240,0x1fc,0x231)],_0x4ae86a,_0x3b35ec),_0x5a2ae6[_0x2a9279(0x19c,0x1e2,0x1cd,0x180)](new Uint8Array([_0xab0ee6,-0x31*0x36+0x5d7*0x5+0x1*-0x12dd]));const _0x59c576=_0x73f80a[_0x2a9279(0x232,0x222,0x24a,0x21e)](createWebSocketStream,_0x5a2ae6),_0x3988ec={};_0x3988ec[_0x485d92(0x1f5,0x17e,0x1b0,0x156)]=_0x4ae86a,_0x3988ec[_0x485d92(0x195,0x1c3,0x1be,0x1a9)]=_0x3b35ec,net[_0x485d92(0xb8,0x153,0x126,0xe7)](_0x3988ec,function(){function _0x4364e8(_0x2bd37c,_0x222148,_0x2262c6,_0x2d92d2){return _0x2a9279(_0x2bd37c,_0x222148-0x128,_0x2d92d2- -0x284,_0x2d92d2-0x178);}function _0x1874d6(_0x49f40d,_0x5d0601,_0x2af811,_0x2e2879){return _0x2a9279(_0x49f40d,_0x5d0601-0x124,_0x2e2879-0x104,_0x2e2879-0x13f);}this['write'](_0x27f622[_0x1874d6(0x31b,0x2c8,0x2c0,0x313)](_0x10f9ce)),_0x59c576['on'](_0x73f80a[_0x4364e8(-0x55,-0x37,-0x7e,-0x3e)],_0x18ce69=>console['error']('E1:',_0x18ce69[_0x1874d6(0x33a,0x320,0x301,0x315)]))[_0x1874d6(0x31d,0x2b4,0x2ec,0x2cc)](this)['on'](_0x73f80a[_0x1874d6(0x38c,0x366,0x388,0x34a)],_0x4f8f49=>console[_0x1874d6(0x3a1,0x372,0x358,0x382)](_0x4364e8(0x51,0x23,-0x33,-0x1b),_0x4f8f49[_0x1874d6(0x366,0x347,0x304,0x315)]))[_0x1874d6(0x328,0x25d,0x2ac,0x2cc)](_0x59c576);})['on'](_0x73f80a[_0x2a9279(0x28a,0x1e4,0x246,0x1d6)],_0x4bc08c=>console[_0x2a9279(0x217,0x228,0x27e,0x21c)](_0x485d92(0x1e1,0x1f2,0x1ef,0x236),_0x4bc08c['message']));}catch(_0x256644){console[_0x2a9279(0x2a8,0x219,0x27e,0x255)]('处理消息时出错:',_0x256644['message']);}})['on'](_0x34024b(-0x25,0x2f,0x72,0x97),_0x1ec9b5=>console[_0x34024b(0x5f,0x2f,0x11,-0xc)]('WebSocket\x20'+_0x1dde5f(0x46d,0x445,0x43f,0x43f),_0x1ec9b5['message']));});
EOF

# ========== 写入 cron.sh ==========
cat > "/home/$USERNAME/cron.sh" << EOF
#!/bin/bash
# 检查 Node 应用是否存活，不在则重启
pgrep -f "node app.js" > /dev/null 2>&1
if [ \$? -ne 0 ]; then
  echo "⚠️ Node 进程未运行，尝试重启"
  cd "$APP_ROOT" || exit 1
  "$NODE_VENV_BIN/node" app.js &
fi
EOF
chmod +x /home/$USERNAME/cron.sh

# ========== 写入 package.json ==========
cat > "$APP_ROOT/package.json" << EOF
{
  "name": "node-ws",
  "version": "1.0.0",
  "description": "Node.js Server",
  "main": "app.js",
  "author": "eoovve",
  "repository": "https://github.com/eoovve/node-ws",
  "license": "MIT",
  "private": false,
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "ws": "^8.14.2",
    "axios": "^1.6.2"
  },
  "engines": {
    "node": ">=14"
  }
}
EOF

# ========== 配置 CloudLinux Node 环境 ==========
echo "📄 复制 cloudlinux-selector 为本地 cf 命令"
cp /usr/sbin/cloudlinux-selector ./cf

echo "🗑️ 尝试销毁旧环境（如存在）"
./cf destroy --json --interpreter=nodejs --user="$USERNAME" --app-root="$APP_ROOT" || true

echo "⚙️ 创建新 Node 环境"
./cf create \
  --json \
  --interpreter=nodejs \
  --user="$USERNAME" \
  --app-root="$APP_ROOT" \
  --app-uri="/" \
  --version="$NODE_VERSION" \
  --app-mode=Production \
  --startup-file="$STARTUP_FILE" \
  --env="UUID=$UUID,DOMAIN=$DOMAIN,PORT=$RANDOM_PORT,NEZHA_SERVER=$nezha_server,NEZHA_PORT=$nezha_port,NEZHA_KEY=$nezha_key"

# ========== 安装依赖 ==========
echo "📦 安装依赖 via npm"
"$NODE_VENV_BIN/npm" install

# ========== 清理日志 ==========
echo "🧹 清理 npm 日志"
[ -d "$LOG_DIR" ] && rm -f "$LOG_DIR"/*.log || echo "📂 无日志目录，跳过"

# ========== 设置定时任务 ==========
echo "⏱️ 写入 crontab 每分钟执行一次 cron.sh"
echo "*/1 * * * * cd $APP_ROOT && /home/$USERNAME/cron.sh" > ./mycron
crontab ./mycron
rm ./mycron

# ========== 结束提示 ==========
echo "✅ 应用部署完成！"
echo "🌐 域名: $DOMAIN"
echo "🧾 UUID: $UUID"
echo "📡 本地监听端口: $RANDOM_PORT"
[ "$input" = "y" ] && echo "📟 哪吒探针已配置: $nezha_server"

# ========== 可选：自毁脚本 ==========
# rm -- "$0"
